# –í —ç—Ç–æ–º –º–æ–¥—É–ª–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ó–∞–¥–∞—á–∞ (Task) –¥–ª—è 5–≥–æ –¥–Ω—è
from aiogram.types import Message
from aiogram.dispatcher import FSMContext

from keyboards.default.menu import menu, pool
from loader import dp
from states.states import Start, Task05
from utils.db_api.db_commands import db_save_task


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ 1–≥–æ –æ—Ç–≤–µ—Ç–∞ (–ù–∞—á–∞—Ç—å) –∫ "–∑–∞–¥–∞—á–∫–µ –Ω–∞ –ø—Ä–æ–∫–∞—á–∫—É" 5-–≥–æ –¥–Ω—è
@dp.message_handler(state=Task05.Answer_05_01)
async def answer_05_01(message: Message, state: FSMContext):
    s = message.text
    data = await state.get_data()
    name_user = data.get("name_user")
    if s == "–í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–µ–π—á–∞—Å!":
        video = open("./VIDEO/–£ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞.mp4", "rb")
        await message.answer_video(video)
        await message.answer("–ö–∞–∫–∏–µ —ç–º–æ—Ü–∏–∏ —É–¥–∞–ª–æ—Å—å –∑–∞–º–µ–Ω–∏—Ç—å —É –ù–æ–≤–æ—Å–µ–ª—å—Ü–µ–≤–∞ –≤ —ç—Ç–æ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ (–ø–µ—Ä–µ—á–∏—Å–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)?",
                             reply_markup=pool)
    elif s == "–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–∑–∂–µ!":
        await message.answer("–ê–≥–∞, –ø–æ–Ω–∏–º–∞—é! –ù–æ —É —Ç–µ–±—è –µ—Å—Ç—å —à–∞–Ω—Å –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —ç—Ç–æ–π –∑–∞–¥–∞—á–∫–µ –¥–æ –Ω–∞—á–∞–ª–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è.",
                             reply_markup=menu)
        await Start.Wait.set()
        return
    else:
        await message.answer("{0}, –∫–ª–∏–∫–Ω–∏ –Ω–∞ —Å–ª—É–∂–µ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´–í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–µ–π—á–∞—Å!¬ª –ø–æ–¥ —Å—Ç—Ä–æ–∫–æ–π –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –Ω–∞"
                             " ¬´–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–∑–∂–µ!¬ª".format(name_user))
        return
    await Task05.next()


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ 2–≥–æ –æ—Ç–≤–µ—Ç–∞ (–≠–º–æ—Ü–∏–∏) –∫ "–∑–∞–¥–∞—á–∫–µ –Ω–∞ –ø—Ä–æ–∫–∞—á–∫—É" 5-–≥–æ –¥–Ω—è
@dp.message_handler(state=Task05.Answer_05_02)
async def answer_05_02(message: Message):
    s = message.text
    await db_save_task(message.from_user.id, 5, s)
    await message.answer('–Ø –∑–∞–º–µ—Ç–∏–ª —É –ù–æ–≤–æ—Å–µ–ª—å—Ü–µ–≤–∞ —Ü–µ–ª—É—é –ø–∞–ª–∏—Ç—Ä—É —ç–º–æ—Ü–∏–π:\n–ü–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º –≤ –∫–∞–±–∏–Ω–µ—Ç - —Ç—Ä–µ–≤–æ–≥–∞.\n–ü—Ä–∏ –≤—Å—Ç—Ä–µ—á'
                         '–µ —Å–æ —Å—Ç–∞—Ä—ã–º –ø—Ä–∏—è—Ç–µ–ª–µ–º - —Ä–∞—Å—Ç–µ—Ä—è–Ω–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –±—ã—Å—Ç—Ä–æ —Å–º–µ–Ω–∏–ª–∞—Å—å —Ä–∞–¥–æ—Å—Ç—å—é –æ—Ç –≤—Å—Ç—Ä–µ—á–∏.\n–†–µ–∞–∫—Ü–∏—è'
                         ' –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è:\n-  ‚Äú–≠—Ç–æ –≤–∞—à –æ—Ç—á–µ—Ç?‚Äù - –æ–∂–∏–¥–∞–Ω–∏–µ (–≤ —Ç–æ–º —á–∏—Å–ª–µ –µ–µ —Ä–µ–∞–∫—Ü–∏–∏ –∏ –∑–∞–º–µ—á–∞–Ω–∏–π'
                         ').\n-  ‚Äú–ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏?‚Äù - –¥–æ—Å–∞–¥–∞.\n–ù–æ–≤–æ—Å—Ç—å –æ –Ω–æ–≤–æ–º –∑–∞–º–µ—Å'
                         '—Ç–∏—Ç–µ–ª–µ –≤—ã–∑–≤–∞–ª–∞ —É–¥–∏–≤–ª–µ–Ω–∏–µ.\n–ê –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –æ–Ω –∏—Å–ø—ã—Ç–∞–ª —Ä'
                         '–∞—Å—Ç–µ—Ä—è–Ω–Ω–æ—Å—Ç—å.')
    await message.answer('–° –ù–æ–≤–æ—Å–µ–ª—å—Ü–µ–≤—ã–º –≤—Å–µ –ø–æ–Ω—è—Ç–Ω–æ, –∞ —Ç—ã –ø–æ–ø—Ä–æ–±—É–π –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å–≤–æ–µ–≥–æ –∫–æ–ª–ª–µ–≥—É (–∏–ª–∏ —Ç–æ–≥'
                         '–æ, –∫—Ç–æ –µ—Å—Ç—å —Ä—è–¥–æ–º) –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ–≥–æ —ç–º–æ—Ü–∏—é. –ö–∞–∫—É—é —ç–º–æ—Ü–∏—é –æ–Ω —Å–µ–π—á–∞—Å –∏—Å–ø—ã—Ç—ã–≤–∞–µ—Ç (–æ—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º —Å'
                         '–ª–æ–≤–æ–º)?')
    await Task05.next()


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ 3–≥–æ –æ—Ç–≤–µ—Ç–∞ (–≠–º–æ—Ü–∏—è —Å–æ—Å–µ–¥–∞) –∫ "–∑–∞–¥–∞—á–∫–µ –Ω–∞ –ø—Ä–æ–∫–∞—á–∫—É" 5-–≥–æ –¥–Ω—è
@dp.message_handler(state=Task05.Answer_05_03)
async def answer_05_03(message: Message, state: FSMContext):
    s = message.text
    data = await state.get_data()
    name_user = data.get("name_user")
    await db_save_task(message.from_user.id, 5, s)
    await message.answer("–£—á—Ç–∏ —ç—Ç—É —ç–º–æ—Ü–∏—é, {0}, –∫–æ–≥–¥–∞ –±—É–¥–µ—à—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–µ–º—É/–Ω–µ–π. üòä".format(name_user),
                         reply_markup=menu)
    await message.answer("{0}, —Å–ø–∞—Å–∏–±–æ –∑–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é —Ä–∞–∑–º–∏–Ω–∫—É.".format(name_user))
    await Start.Wait.set()
